/*
Bones Scripts File
Author: Emil Broll
*/// Warn old browsers to update/switch
function isNear(e,t,n){var r=e.offset().left-t,i=e.offset().top-t,s=r+e.width()+2*t,o=i+e.height()+2*t,u=n.pageX,a=n.pageY;return u>r&&u<s&&a>i&&a<o}var $buoop={};$buoop.ol=window.onload;window.onload=function(){try{$buoop.ol&&$buoop.ol()}catch(e){}var e=document.createElement("script");e.setAttribute("type","text/javascript");e.setAttribute("src","//browser-update.org/update.js");document.body.appendChild(e)}(function(e){e(".singlepaged").length!==0&&e("iframe").each(function(){})}(jQuery));jQuery(document).ready(function(e){var t=e(window).width();if(e(".grid").length>0){var n=0;e("img.lazy").unveil(500,function(){if(n===0)return;setTimeout(function(){n.layout()},500)});var r=0;r!==0&&r<=8&&setInterval(function(){if(n===0)return;n.layout()},3e3);if(t>=768){imagesLoaded(container,function(){jQuery(".grid").removeClass("nomasonry");var t=e("#main");t.height(t.height());var r=document.querySelector("#main");n=new Masonry(r,{itemSelector:".grid",gutter:"#gutter"})});var i=function(t,n){var r=e(t).attr("series");if(n){e(t).find(".entry-content").fadeIn(100);e('article[series="'+r+'"] #article-image').fadeTo(100,.5)}else{e(t).find(".entry-content").fadeOut(100);e('article[series="'+r+'"] #article-image').fadeTo(100,1)}};e(".grid").hover(function(t){i(e(this),!0)},function(t){i(e(this),!1)})}var s=function(t){if(t===!0&&s.on!==!0)return;if(s.on===!0||t===!0){e("#inner-info").slideUp();Modernizr.rgba?e(".header").css("background","rgba(255,255,255,0.5)"):e(".header").css("background",'url("../images/black06.png") repeat');e(".header").css("position","fixed");e("#infobutton .genericon").hide();e("#infobutton #infospan").show();e(".singlepaged").length!==0&&e.fn.fullpage.setAutoScrolling(!0);s.on=!1}else{e(".header").css("background","#f9cdb7");e(".header").css("position","absolute");e("#infobutton .genericon").show();e("#infobutton #infospan").hide();if(e(".singlepaged").length!==0){e.fn.fullpage.moveTo(1);e(".singlepaged").length!==0&&e.fn.fullpage.setAutoScrolling(!1)}else e("html,body").animate({scrollTop:0},300);e("#inner-info").slideDown();s.on=!0}};e("#infobutton").click(s);e(document).mouseup(function(t){if(s.on!==!0)return;var n=e(".header");!n.is(t.target)&&n.has(t.target).length===0&&s(!0)})}var o=function(n){var r=!1,i=!1,s=function(){n.find("figure, .video-overlay").addClass("overlay");n.find(".entry-content").fadeIn();n.find(".fp-controlArrow").fadeTo(400,1)},o=function(){r||n.find(".fp-controlArrow").fadeTo(400,0);if(!i){n.find(".entry-content").fadeOut();n.find("figure, .video-overlay").delay(200).removeClass("overlay")}};s();setTimeout(function(){o()},2e3);if(t>=768){n.find("figure, .video-overlay").eq(0).hover(function(){i=!0;e(this).data("hovering",!0);if(e(this).hasClass("overlay"))return;s()});var u=0,a=function(){e(".fp-controlArrow").fadeTo(400,0);clearTimeout(u);u=0;r=!1};e(n).mousemove(function(t){if(isNear(n.find(".fp-controlArrow.fp-prev"),e(window).width()/5,t)||isNear(n.find(".fp-controlArrow.fp-next"),e(window).width()/5,t))if(u===0&&!r){e(".fp-controlArrow").fadeTo(400,1);r=!0}else{clearTimeout(u);u=0}else r&&u===0&&(u=setTimeout(a,500));n.find("figure, .video-overlay").eq(0).each(function(n){if(!isNear(e(this),1,t)&&e(this).data("hovering")===!0){var r=e(this);r.data("hovering",!1);i=!1;setTimeout(function(){o()},800)}})})}};if(e(".singlepaged").length!==0){Backbone.$=e;var u=window.location.pathname.split("/");u.splice(-2,2);Backbone.history.start({pushState:Modernizr.history,root:u.length>1?u.join("/"):"/"});if(!Modernizr.history){var a=Backbone.history.options.root.length,f=window.location.pathname.substr(a);Backbone.history.navigate(f,{trigger:!0})}e("#main").fullpage({resize:!1,css3:!0,fixedElements:".header",autoScrolling:!0,paddingTop:e(".header").height()+"px",paddingBottom:e(".header").height()+"px",afterLoad:function(t,n){var r=e("article:eq("+(n-1)+")");r.find("iframe").each(function(){e(this).attr("src",e(this).attr("data"))});var i=r.attr("slug");Backbone.history.navigate(i,{trigger:!0});document.title="Thomas Brun â€¢ "+r.attr("title");o(r)},onLeave:function(t,n){var r=e("article:eq("+(t-1)+")");r.find("iframe").each(function(){e(this).delay(1e3).queue(function(){e(this).attr("src","");e(this).dequeue()})})},afterRender:function(){var t=e("article").eq(0);o(t)}});e("figure").click(function(){console.log();e(".section.active").find(".fp-controlArrow.next:visible").trigger("click")})}});(function(e){function c(){n.setAttribute("content",s);o=!0}function h(){n.setAttribute("content",i);o=!1}function p(t){l=t.accelerationIncludingGravity;u=Math.abs(l.x);a=Math.abs(l.y);f=Math.abs(l.z);!e.orientation&&(u>7||(f>6&&a<8||f<8&&a>6)&&u>5)?o&&h():o||c()}if(!(/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1))return;var t=e.document;if(!t.querySelector)return;var n=t.querySelector("meta[name=viewport]"),r=n&&n.getAttribute("content"),i=r+",maximum-scale=1",s=r+",maximum-scale=10",o=!0,u,a,f,l;if(!n)return;e.addEventListener("orientationchange",c,!1);e.addEventListener("devicemotion",p,!1)})(this);window.getComputedStyle||(window.getComputedStyle=function(e,t){this.el=e;this.getPropertyValue=function(t){var n=/(\-([a-z]){1})/g;t=="float"&&(t="styleFloat");n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()}));return e.currentStyle[t]?e.currentStyle[t]:null};return this});